// 1. 连接测试服务器（Auto Update），已替换为你的Render测试服务器实际URL
const testSocket = io("https://auto-update-zj4.onrender.com");
// 2. 已添加内容容器id为"dynamic-content"
const testContentContainer = document.getElementById("dynamic-content");

// 初始化：页面打开时，自动加载Auto Update服务器的最新HTML
window.onload = async () => {
  await loadLatestTestHtml();
};

// 核心函数：加载Auto Update服务器存储的最新HTML（适配你上传到GitHub的任意文件）
async function loadLatestTestHtml() {
  try {
    const response = await fetch("https://auto-update-zj4.onrender.com/get-latest-nrgx-html");
    const latestTestHtml = await response.text();
    testContentContainer.innerHTML = latestTestHtml; // 直接渲染你上传的最新内容
  } catch (err) {
    console.error("加载测试HTML失败，错误信息：", err);
  }
}

// 监听更新：你往GitHub上传新文件后，服务器会自动广播更新，页面无需操作即可同步
testSocket.on('nrgx-html-updated', (data) => {
  console.log(data.msg);
  loadLatestTestHtml(); 
});
